From f8cc7391472b3fe3d830124ac90b3c67d642afd9 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Fr=C3=A9d=C3=A9ric=20Pierret=20=28fepitre=29?=
 <frederic.epitre@orange.fr>
Date: Fri, 19 Oct 2018 08:02:11 +0200
Subject: [PATCH] anaconda: fix grub config setup by removing non-xen options

---
 pyanaconda/bootloader.py | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/pyanaconda/bootloader.py b/pyanaconda/bootloader.py
index a37f91b9a..68fca98bf 100644
--- a/pyanaconda/bootloader.py
+++ b/pyanaconda/bootloader.py
@@ -1558,6 +1558,9 @@ class GRUB2(GRUB):
         except (BootLoaderError, OSError, RuntimeError) as e:
             log.error("boot loader password setup failed: %s", e)
 
+        # disable non-xen entries
+        os.chmod("%s/etc/grub.d/10_linux" % iutil.getSysroot(), 0o644)
+
         # make sure the default entry is the OS we are installing
         if self.default is not None:
             # find the index of the default image
-- 
2.17.1

